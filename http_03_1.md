# Chapter 1. Basics - Unit 3. HTTP Messages - section 1 ~ 3

## 1. 메시지의 흐름

- HTTP 메시지는 HTTP 애플리케이션 간에 주고받는 데이터의 블록
- 메시지의 내용과 의미를 설명하는 메타정보로 시작하고, 뒤에 선택적으로 데이터가 올 수 있음
- 클라이언트, 서버, 프락시 사이를 흐름
- 메시지의 진행 방향
    - 인바운드 : 클라이언트 → 서버
    - 아웃바운드 : 서버 → 클라이언트(사용자 에이전트)
    - 요청/응답 관계없이 업스트림 → 다운스트림으로 흐름 (상황에 따라 업스트림/다운스트림이 변화함)

## 2. 메시지의 구성

- 메시지 개체(Entity)는 요청 또는 응답 중 하나로 분류됨
- 구성
    - 시작줄 : 어떤 메시지인지 서술
    - 헤더 : 속성
    - 본문 : 데이터를 담고있거나 없음

### 2.1 문법

- 요청 메시지는 명령과 URL을 포함한다

```
<메서드> <요청URL> <버전>
<헤더>
<엔터티 본문>
```

- 응답 메시지는 트랜잭션의 결과를 포함한다

```
<버전> <상태코드> <사유구절>
<헤더>
<엔터티본문>
```

### 2.2 시작줄

- 요청 메시지라면 무엇을 해야 하는지
- 응답 메시지라면 무슨 일이 일어났는지
- 요청줄/응답줄 : 공백으로 구분
    - 메서드
    - 상태코드와 사유구절
    - 버전번호 : 애플리케이션이 **지원하는 가장 높은** HTTP 버전

### 2.3 헤더

- 요청과 응답 메시지에 대한 추가 정보
- 한 개의 헤더를 줄로 나눌 수 있다. 단, 하나 이상의 스페이스 또는 탭을 이용해야 한다
- 종류
    - 일반 헤더
    - 요청 헤더
    - 응답 헤더
    - 엔터티 헤더
    - 확장 헤더

### 2.4 본문

- 이미지, 비디오, HTML문서, 소프트웨어 애플리케이션, 신용카드 트랜잭션, 전자우편 등 여러 종류의 디지털 데이터

## 3. 메서드

- 안전한 메서드 : HTTP 요청의 결과로 서버에 어떤 작용도 없는 메서드 ex. GET, HEAD
- GET
    - 서버에게 리소스를 달라고 요청
    - HTTP/1.1 은 서버가 이 메서드를 구현할 것을 요구
- HEAD
    - 정확히 GET 처럼 행동하지만 응답으로 헤더만을 받음
    - 리소스를 실제로 가져오지 않고 조사할 수 있음
        - 타입을 알 수 있음
        - 개체가 존재하는지 알 수 있음(상태코드)
        - 리소스가 변경되었는지 알 수 있음
    - HTTP/1.1 은 서버가 이 메서드를 구현할 것을 요구
- PUT
    - 서버에 있는 리소스에 데이터를 입력
    - 서버가 요청의 본문을 가지고 **요청 URL 의 이름대로 새 문서를 만들거나** 이미 URL 이 존재한다면 본문을 사용해서 교체함
    - 콘텐츠를 변경하도록 하기 때문에 많은 웹 서버는 PUT을 수행하기 전 사용자에게 비밀번호를 입력해서 로그인을 하도록 요구함(또는 요청 헤더의 토큰 확인)
- POST
    - 서버에 입력 데이터를 전송함
    - HTML 폼을 지원
- TRACE
    - 요청이 서버에 도달했을 때 어떻게 보이는지 알려줌
    - 클라이언트의 요청은 방화벽, 프락시, 게이트웨이 등의 애플리케이션을 통과하는데, 이 때 원래 HTTP 요청이 수정될 수 있기 때문
    - 목적지 서버에서 루프백(Loopback) 진단 - 자신이 받은 메시지를 본문에 넣어 TRACE 응답
    - 요청 메시지에 어떤 엔터티 본문도 보낼 수 없음
    - 응답 메시지는 서버가 받은 요청만 들어있음
    - 용도
        - 요청이 의도한 요청/응답 연쇄를 거쳐가는지 검사
        - 프락시 등 다른 애플리케이션이 요청에 어떤 영향을 미치는지 확인
- OPTIONS
    - 웹 서버에게 (특정 리소스에 대해) 메서드 지원범위를 물어봄
- DELETE
    - 요청 URL로 지정한 리소스를 삭제
    - 삭제 수행을 보장하지는 않음(명세)
- 확장 메서드
    - HTTP 는 개발자가 기능을 확장해도 문제가 없도록 설계되었으므로 새로운 메서드를 추가해도 과거에 구현된 소프트웨의 오동작을 유발하지 않음
    - 서버의 리소스에 대한 능력을 확장
    - “엄격하게 보내고 관대하게 받아들여라”
        - 프락시는 end-to-end 행위를 망가뜨리지 않는 한 알려지지 않은 메서드가 담긴 메시지를 다운스트림 서버로 전달한다
    - 대표적인 예
        - LOCK : 사용자가 리소스를 잠금(예 - 문서 편집 중 다른 사람이 동시에 편집하지 못하도록)
        - MKCOL : 사용자가 문서를 생성
        - COPY : 복사
        - MOVE : 옮김
